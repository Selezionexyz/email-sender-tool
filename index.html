<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Sender Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        
        .section {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #444;
        }
        
        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #4CAF50;
        }
        
        textarea {
            min-height: 200px;
            resize: vertical;
        }
        
        .email-list {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 6px;
            max-height: 200px;
            overflow-y: auto;
            font-size: 13px;
            color: #666;
        }
        
        .email-item {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        
        .btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background: #45a049;
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            display: none;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #cce5ff;
            color: #004085;
            border: 1px solid #b8daff;
        }
        
        .progress {
            margin-top: 20px;
            display: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #4CAF50;
            transition: width 0.3s;
            width: 0%;
        }
        
        .progress-text {
            margin-top: 10px;
            text-align: center;
            color: #666;
        }
        
        .help-text {
            font-size: 13px;
            color: #666;
            margin-top: 5px;
        }
        
        .config-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        
        .config-section h3 {
            color: #856404;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìß Email Sender Pro</h1>
        <p class="subtitle">Envoyez des emails personnalis√©s avec suivi d'ouverture</p>
        
        <div class="config-section">
            <h3>‚öôÔ∏è Configuration EmailJS (√† faire une seule fois)</h3>
            <ol>
                <li>Cr√©ez un compte gratuit sur <a href="https://www.emailjs.com/" target="_blank">EmailJS.com</a></li>
                <li>Ajoutez votre service email (Gmail, Outlook, etc.)</li>
                <li>Cr√©ez un template avec les variables: {{from_name}}, {{to_email}}, {{prenom}}, {{message}}</li>
                <li>Copiez vos IDs ci-dessous</li>
            </ol>
        </div>
        
        <div class="section">
            <label>Service ID EmailJS:</label>
            <input type="text" id="serviceId" placeholder="Ex: service_abc123" value="">
            <p class="help-text">Trouvez-le dans EmailJS > Email Services</p>
        </div>
        
        <div class="section">
            <label>Template ID EmailJS:</label>
            <input type="text" id="templateId" placeholder="Ex: template_xyz789" value="">
            <p class="help-text">Trouvez-le dans EmailJS > Email Templates</p>
        </div>
        
        <div class="section">
            <label>Public Key EmailJS:</label>
            <input type="text" id="publicKey" placeholder="Ex: user_key123456" value="">
            <p class="help-text">Trouvez-le dans EmailJS > Account > General</p>
        </div>
        
        <div class="section">
            <label>Votre nom/entreprise:</label>
            <input type="text" id="fromName" placeholder="Ex: Jean Dupont" value="">
        </div>
        
        <div class="section">
            <label>Objet de l'email:</label>
            <input type="text" id="subject" placeholder="Ex: Opportunit√© de collaboration exclusive" value="">
        </div>
        
        <div class="section">
            <label>Message (utilisez {{prenom}} pour personnaliser):</label>
            <textarea id="emailTemplate" placeholder="Bonjour {{prenom}},

J'esp√®re que vous allez bien. Je vous contacte car...

Cordialement,
[Votre nom]">Bonjour {{prenom}},

J'esp√®re que ce message vous trouve en bonne sant√©.

Je repr√©sente [Votre entreprise] et je pense que nous pourrions avoir des opportunit√©s de collaboration int√©ressantes √† explorer ensemble.

Seriez-vous disponible pour un bref √©change t√©l√©phonique cette semaine ?

Cordialement,
[Votre nom]</textarea>
        </div>
        
        <div class="section">
            <label>Liste des destinataires (50 emails charg√©s):</label>
            <div class="email-list" id="emailList">
                <!-- Liste sera affich√©e ici -->
            </div>
        </div>
        
        <button class="btn" onclick="startSending()">üöÄ Envoyer les emails</button>
        
        <div class="progress" id="progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">0/50 emails envoy√©s</div>
        </div>
        
        <div class="status" id="status"></div>
    </div>

    <script>
        // Liste d'emails fournie
        const emailsList = [
            "sasakura@sunbrand.co.jp", "kogure@sunbrand.co.jp",
            "t-isaka@portodimoda.co.jp", "y-kinoshita@portodimoda.co.jp",
            "tina@shangpin.com", "lisa.dong@shangpin.com", "bd4@shangpin.com", "liming@shangpin.com",
            "kim_hyemin@eland.co.kr", "bhkang@eland.co.kr", "LEE_GIJUNG@eland.co.kr", "kim_hosu@eland.co.kr",
            "bizplan8@hotmail.com",
            "yoshiko_yin@milanyi.cn", "yinml@milanyi.cn",
            "lorenzozl@outlook.com",
            "Ellen.Lafaut@hautefashion.eu", "Eveline.tant@hautefashion.eu", "maurizio.girini@hautefashion.eu", "Kitty.pang@hautefashion.eu",
            "topoptik@hotmail.com",
            "midori@ottoemezzo.jp",
            "hkliuyi@corp.netease.com", "hzchengmingzhu@corp.netease.com", "hzjianglixian@corp.netease.com", "hzxieyi@corp.netease.com", "hzzengyiyun@corp.netease.com",
            "stella.hong@hotmail.it",
            "jlrvogue88@gmail.com",
            "omihee910407@okmall.com",
            "jenny@mukita.com", "ritesh@mukita.com", "antonia@mukita.com",
            "karen.chia@reebonz.com", "daniel.lim@reebonz.com", "charlene.lim@reebonz.com",
            "y.konishi@gruppotanaka.jp",
            "betsy.chen@vipshop.co", "aimee.wei@vipshop.co",
            "michelle_park@lotteshopping.com", "q_do@lotteshopping.com", "jhkim01@lotteshopping.com", "kminjikk@lotteshopping.com", "sjjung@lotteshopping.com", "peteryeo@lotteshopping.com",
            "peng@goldcoast-ie.com",
            "jena910407@naver.com", "ryuer1@naver.com",
            "sitoh@mac.com",
            "info@albawestbest.com",
            "clubfashionbuyer@gmail.com",
            "filippo.chen@qq.com",
            "kubob@mtd.biglobe.ne.jp",
            "charlee@keal-design.com",
            "cenkoymakk@gmail.com",
            "chiara_jie@hotmail.com",
            "philip@lorenzbach.com",
            "alice@giovanni-china.com",
            "briancc67@hotmail.com",
            "andrewchee01@gmail.com",
            "aayumi.zhu@mei.com",
            "aarounmps@gmail.com",
            "golddays@netvigator.com",
            "civatti@redigroup.it",
            "novocosmos@outlook.com",
            "fanny.f@wintop-asiapacific.com",
            "apkchoi@hanmail.net",
            "cho@swikoah.com",
            "queeniewang@coscia.com.cn",
            "valentina.besttrip@gmail.com",
            "Oscar.li@kuajing.com",
            "oscar@perfecttrading123.com",
            "sakshi@inceincorporation.com", "chandra@inceincorporation.com", "nand@inceincorporation.com",
            "amit@grupomarina.es",
            "boaz@cameogrp.com",
            "mjtradingmike@gmail.com",
            "progetto@progettointernazionale.it",
            "f.gottardi@mctradingitaly.com", "g.chen.di@mctradingitaly.com",
            "info@kean.global", "herbie@iconapparelgroup.com", "joe@iconapparelgroup.com", "meyer@iconapparelgroup.com", "abie@iconapparelgroup.com", "michael.a@iconapparelgroup.com", "angela@iconapparelgroup.com"
        ];
        
        // Afficher la liste des emails
        function displayEmails() {
            const listContainer = document.getElementById('emailList');
            emailsList.forEach((email, index) => {
                const div = document.createElement('div');
                div.className = 'email-item';
                div.textContent = `${index + 1}. ${email} (${extractName(email)})`;
                listContainer.appendChild(div);
            });
        }
        
        // Extraire le pr√©nom de l'email
        function extractName(email) {
            const username = email.split('@')[0];
            let name = username.split(/[._-]/)[0];
            
            // Cas sp√©ciaux
            if (name === 't' && username.includes('isaka')) name = 'isaka';
            if (name === 'y' && username.includes('kinoshita')) name = 'kinoshita';
            if (name === 'g' && username.includes('chen')) name = 'chen';
            if (name === 'f' && username.includes('gottardi')) name = 'gottardi';
            if (name === 'q' && username.includes('do')) name = 'do';
            
            // Capitaliser la premi√®re lettre
            return name.charAt(0).toUpperCase() + name.slice(1).toLowerCase();
        }
        
        // Envoyer les emails
        async function startSending() {
            const serviceId = document.getElementById('serviceId').value;
            const templateId = document.getElementById('templateId').value;
            const publicKey = document.getElementById('publicKey').value;
            const fromName = document.getElementById('fromName').value;
            const subject = document.getElementById('subject').value;
            const template = document.getElementById('emailTemplate').value;
            
            if (!serviceId || !templateId || !publicKey || !fromName || !template) {
                showStatus('Veuillez remplir tous les champs requis', 'error');
                return;
            }
            
            // Initialiser EmailJS
            emailjs.init(publicKey);
            
            const btn = document.querySelector('.btn');
            btn.disabled = true;
            btn.textContent = '‚è≥ Envoi en cours...';
            
            document.getElementById('progress').style.display = 'block';
            
            let successCount = 0;
            let errorCount = 0;
            
            for (let i = 0; i < emailsList.length; i++) {
                const email = emailsList[i];
                const prenom = extractName(email);
                const personalizedMessage = template.replace(/{{prenom}}/g, prenom);
                
                try {
                    // Param√®tres pour EmailJS
                    const params = {
                        from_name: fromName,
                        to_email: email,
                        prenom: prenom,
                        subject: subject,
                        message: personalizedMessage,
                        reply_to: email
                    };
                    
                    await emailjs.send(serviceId, templateId, params);
                    successCount++;
                    
                } catch (error) {
                    console.error(`Erreur pour ${email}:`, error);
                    errorCount++;
                }
                
                // Mise √† jour de la progression
                const progress = ((i + 1) / emailsList.length) * 100;
                document.getElementById('progressFill').style.width = progress + '%';
                document.getElementById('progressText').textContent = `${i + 1}/${emailsList.length} emails trait√©s`;
                
                // Pause entre les envois pour √©viter les limites
                if (i < emailsList.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
            
            btn.disabled = false;
            btn.textContent = 'üöÄ Envoyer les emails';
            
            if (errorCount === 0) {
                showStatus(`‚úÖ Tous les emails ont √©t√© envoy√©s avec succ√®s! (${successCount} emails)`, 'success');
            } else {
                showStatus(`‚ö†Ô∏è Envoi termin√©: ${successCount} r√©ussis, ${errorCount} √©checs`, 'info');
            }
        }
        
        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
        }
        
        // Charger la liste au d√©marrage
        displayEmails();
        
        // Sauvegarder les configs dans le localStorage
        document.getElementById('serviceId').addEventListener('change', function() {
            localStorage.setItem('emailjs_service', this.value);
        });
        document.getElementById('templateId').addEventListener('change', function() {
            localStorage.setItem('emailjs_template', this.value);
        });
        document.getElementById('publicKey').addEventListener('change', function() {
            localStorage.setItem('emailjs_public', this.value);
        });
        
        // Charger les configs sauvegard√©es
        window.onload = function() {
            document.getElementById('serviceId').value = localStorage.getItem('emailjs_service') || '';
            document.getElementById('templateId').value = localStorage.getItem('emailjs_template') || '';
            document.getElementById('publicKey').value = localStorage.getItem('emailjs_public') || '';
        };
    </script>
</body>
</html>
